package com.sist.model;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import com.sist.dao.*;

public class ChallengeModel {
	public void challengeListData(HttpServletRequest request)
	{
		String page = request.getParameter("page");
		String cate = request.getParameter("cate");
		
		if(page==null)
			page="1";
		
		int curpage=Integer.parseInt(page);
		int rowSize=20;
		int start=rowSize*(curpage-1)+1;
		int end=rowSize*curpage;
		
		Map map = new HashMap();
		map.put("start", start);
		map.put("end",end);
		map.put("cate",cate);
		
		List<ChallengeVO> list = ChallengeDAO.challengeListData(map);
				
		for(ChallengeVO vo:list)
		{
			String str= vo.getTitle();
			if(str.length()>20)
			{
				str=str.substring(0,20);
				str+="...";
			}
			vo.setTitle(str);
		}
		
		int totalpage=ChallengeDAO.challengeTotalPage();
		
		request.setAttribute("list", list);
		request.setAttribute("totalpage", totalpage);
		request.setAttribute("curpage", curpage);
		
		
	}

}
